# Critical CVEs Affecting Next.js Stack (2024-2025)

This document tracks high-severity CVEs affecting Next.js, React, and related technologies, with specific remediation steps.

## Next.js CVEs

### CVE-2025-29927 - Next.js Middleware Authentication Bypass (CRITICAL)

**Severity:** Critical (CVSS 9.1)  
**Affected Versions:** Next.js < 14.2.19, < 15.1.4  
**Disclosure Date:** December 2024  
**Status:** Patched

**Description:**
A critical vulnerability in Next.js middleware allows attackers to bypass authentication checks by manipulating request headers and paths. The vulnerability stems from how middleware handles certain edge cases in route matching and header forwarding.

**Attack Vector:**
Attackers can craft requests with specific headers that cause middleware authentication checks to be skipped, gaining unauthorized access to protected routes and resources.

**Affected Code Pattern:**
```typescript
// middleware.ts
// ❌ VULNERABLE - Middleware auth bypass
export function middleware(request: NextRequest) {
  const token = request.cookies.get('session')?.value
  
  if (!token) {
    return NextResponse.redirect(new URL('/login', request.url))
  }
  
  return NextResponse.next()
}

export const config = {
  matcher: ['/dashboard/:path*', '/api/:path*']
}
```

**Remediation:**

1. **Immediate:** Update Next.js to patched version
```bash
npm install next@latest
# Or specifically:
npm install next@14.2.19  # For Next.js 14.x
npm install next@15.1.4   # For Next.js 15.x
```

2. **Architectural:** Migrate away from middleware-based authentication
```typescript
// lib/dal/auth.ts
// ✅ SECURE - Data Access Layer pattern
export const requireAuth = async () => {
  const session = await getSession()
  if (!session) {
    throw new Error('Unauthorized')
  }
  return session
}

// Use in Server Components and Server Actions
export async function getProtectedData() {
  await requireAuth() // Authentication check
  // ... fetch data
}
```

3. **Defense in Depth:** Add authentication checks at multiple layers
   - Data Access Layer (primary)
   - Server Actions
   - Page components
   - API routes

**Verification:**
```bash
# Check Next.js version
npm list next

# Should show >= 14.2.19 or >= 15.1.4
```

**Additional Notes:**
- Vercel deployed platform-level mitigations to protect hosted apps
- Even with platform protection, updating is still required
- This CVE led to the official recommendation against middleware auth

---

### CVE-2025-30218 - Next.js Edge Runtime Security Issue (LOW-MEDIUM)

**Severity:** Low to Medium  
**Affected Versions:** Specific edge runtime configurations  
**Disclosure Date:** December 2024  
**Status:** Patched by infrastructure providers

**Description:**
A lower-severity issue identified during analysis of CVE-2025-29927 affecting the Edge runtime. Vercel patched this at the infrastructure level.

**Remediation:**
- Update to latest Next.js version
- Verify deployment on Vercel or other providers with patched edge infrastructure
- No code changes required

---

### CVE-2024-51479 - Next.js Middleware Path Traversal (HIGH)

**Severity:** High (CVSS 7.5)  
**Affected Versions:** Next.js < 14.2.10  
**Disclosure Date:** October 2024  
**Status:** Patched

**Description:**
Path traversal vulnerability in Next.js middleware allowing attackers to access files and routes outside intended scope.

**Remediation:**
```bash
npm install next@14.2.10 # Or later
```

---

### CVE-2024-34351 - Next.js Server-Side Request Forgery (SSRF) (HIGH)

**Severity:** High (CVSS 8.6)  
**Affected Versions:** Next.js < 14.1.1  
**Disclosure Date:** May 2024  
**Status:** Patched

**Description:**
SSRF vulnerability in Next.js Server Actions allowing attackers to make unauthorized requests to internal services.

**Attack Vector:**
Specially crafted Server Action invocations could trigger requests to internal network resources, potentially exposing sensitive information or services.

**Affected Code Pattern:**
```typescript
// Server Action vulnerable to SSRF
'use server'
export async function fetchData(url: string) {
  // ❌ User-controlled URL without validation
  const response = await fetch(url)
  return response.json()
}
```

**Remediation:**

1. Update Next.js:
```bash
npm install next@14.1.1 # Or later
```

2. Validate and whitelist URLs:
```typescript
'use server'
const ALLOWED_DOMAINS = ['api.example.com', 'cdn.example.com']

export async function fetchData(url: string) {
  const parsedUrl = new URL(url)
  
  // ✅ Validate domain
  if (!ALLOWED_DOMAINS.includes(parsedUrl.hostname)) {
    throw new Error('Invalid URL domain')
  }
  
  // ✅ Prevent internal network access
  if (parsedUrl.hostname === 'localhost' || 
      parsedUrl.hostname.startsWith('192.168.') ||
      parsedUrl.hostname.startsWith('10.') ||
      parsedUrl.hostname.startsWith('172.')) {
    throw new Error('Internal network access not allowed')
  }
  
  const response = await fetch(url)
  return response.json()
}
```

---

## React CVEs

### React Server Components Authentication Bypass (December 2025)

**Severity:** Critical  
**Affected Versions:** Multiple React versions  
**Disclosure Date:** December 3, 2025  
**Status:** Patched

**Description:**
Critical vulnerability in React Server Components allowing authentication bypass through malicious request patterns.

**Remediation:**
- Update React to latest patched version
- Vercel deployed platform-level mitigations
- Follow Data Access Layer pattern for authentication

**Note:** Vercel customers were protected by platform-level safeguards, but updates still recommended.

---

## React Router / Remix CVEs

### CVE-2025-43864 & CVE-2025-43865 - Cache Poisoning / DoS

**Severity:** High  
**Affected Versions:** React Router and Remix  
**Status:** Patched

**Description:**
Vulnerabilities that could lead to cache poisoning and denial of service attacks.

**Remediation:**
- Update React Router and Remix to latest versions
- Vercel deployed firewall mitigations and purged affected caches
- Verify cache configuration is secure

---

## Third-Party Dependencies

### SAMLStorm - CVE-2025-29774 & CVE-2025-29775

**Severity:** Critical (SAML authentication bypass)  
**Affected:** Various SAML implementations  
**Status:** Mitigated by Vercel Firewall

**Description:**
Critical SAML authentication bypass vulnerability affecting multiple libraries.

**Remediation:**
- Update SAML libraries to patched versions
- Vercel deployed firewall-level protection
- Review SAML authentication implementation

---

## Security Update Timeline

| CVE | Severity | Disclosure | Patch Available | Vercel Mitigation |
|-----|----------|------------|-----------------|-------------------|
| CVE-2025-29927 | Critical | Dec 2024 | ✅ Next.js 14.2.19, 15.1.4 | ✅ Platform-level |
| CVE-2025-30218 | Low-Med | Dec 2024 | ✅ Infrastructure | ✅ Edge patched |
| CVE-2024-51479 | High | Oct 2024 | ✅ Next.js 14.2.10 | ✅ Platform-level |
| CVE-2024-34351 | High | May 2024 | ✅ Next.js 14.1.1 | N/A |
| React SC Bypass | Critical | Dec 2025 | ✅ React patched | ✅ Platform-level |

---

## Checking Your Application

### Quick Version Check

```bash
# Check all versions
npm list next react react-dom

# Check for known vulnerabilities
npm audit --production

# Check for specific CVEs
npm audit | grep -E "CVE-2025-29927|CVE-2024-51479|CVE-2024-34351"
```

### Minimum Safe Versions

```json
{
  "dependencies": {
    "next": "^15.1.4",        // or ^14.2.19
    "react": "^19.0.0",       // or latest 18.x with patches
    "react-dom": "^19.0.0"    // or latest 18.x with patches
  }
}
```

---

## Remediation Priority Matrix

### Immediate Action Required (CRITICAL)

1. **CVE-2025-29927** - Update Next.js immediately
   - Stop using middleware for authentication
   - Implement Data Access Layer
   - Deploy updates to production within 24 hours

2. **React SC Bypass** - Update React
   - Verify authentication checks in Server Components
   - Deploy updates immediately

### Urgent (HIGH - Within 1 Week)

3. **CVE-2024-51479** - Update Next.js
   - Review middleware path handling
   - Test for path traversal vulnerabilities

4. **CVE-2024-34351** - Update Next.js
   - Audit all Server Actions for SSRF risks
   - Implement URL validation

### Important (MEDIUM - Within 1 Month)

5. Regular dependency updates
6. Enable automated security scanning
7. Implement security monitoring

---

## Prevention Strategies

### 1. Automated Dependency Updates

**Setup Dependabot:**
```yaml
# .github/dependabot.yml
version: 2
updates:
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
    open-pull-requests-limit: 10
    # Auto-merge security patches
    labels:
      - "dependencies"
      - "security"
```

### 2. CI/CD Security Checks

```yaml
# .github/workflows/security.yml
name: Security Audit

on: [push, pull_request]

jobs:
  audit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
      - run: npm ci
      - run: npm audit --production --audit-level=high
      - run: npm outdated
```

### 3. Security Monitoring

**Set up alerts for:**
- New CVEs affecting your dependencies
- Failed security audits in CI/CD
- Unusual patterns in application logs
- Authentication failures

### 4. Regular Updates Schedule

- **Weekly:** Check for security updates
- **Monthly:** Update all dependencies
- **Quarterly:** Review and update major versions
- **Immediately:** Apply critical security patches

---

## Additional Resources

### Official Security Advisories

- [Next.js Security](https://nextjs.org/docs/app/guides/security)
- [Vercel Security Updates](https://vercel.com/security)
- [React Security](https://react.dev/learn/keeping-components-pure#detecting-impure-calculations-with-strict-mode)

### CVE Databases

- [National Vulnerability Database](https://nvd.nist.gov/)
- [GitHub Security Advisories](https://github.com/advisories)
- [Snyk Vulnerability Database](https://security.snyk.io/)

### Security Mailing Lists

- [Next.js Security Announcements](https://github.com/vercel/next.js/security/advisories)
- [npm Security Advisories](https://github.com/advisories)
- [Vercel Status & Security](https://www.vercel-status.com/)

---

## Emergency Response Checklist

When a critical CVE is announced:

- [ ] **Assess Impact** - Does it affect your version?
- [ ] **Test Patch** - Apply update in development/staging
- [ ] **Review Changes** - Check for breaking changes
- [ ] **Deploy Urgently** - Critical patches within 24-48 hours
- [ ] **Verify Fix** - Confirm vulnerability is resolved
- [ ] **Document** - Record what was done and when
- [ ] **Communicate** - Inform stakeholders and team
- [ ] **Monitor** - Watch for issues post-deployment

---

## Summary

The Next.js ecosystem has seen several critical security vulnerabilities in 2024-2025, particularly around authentication and Server Components. The key takeaways:

1. **Middleware is no longer safe for authentication** - Use Data Access Layer
2. **Keep Next.js and React updated** - Patches are critical
3. **Defense in depth** - Multiple layers of security checks
4. **Automated monitoring** - Don't rely on manual checks
5. **Rapid response** - Have a process for emergency patches

**Current recommendation:** Next.js >= 15.1.4 (or >= 14.2.19) with Data Access Layer authentication pattern.
